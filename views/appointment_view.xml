<?xml version="1.0" encoding="UTF-8"?>
<odoo>
	 <!--form view of the patient model-->
    <record id="appointment_form" model="ir.ui.view">
        <field name="name">hospital.patient.form</field>
        <field name="model">hospital.patient_appointment</field>
        <field name="arch" type="xml">
            <form string="Patients">
	            <header>
		            <button name="action_in_consultation" string="In Consultation" type="object"
		                    class="oe_highlight" confirm="Make This Appointment in Consultation?" states="draft"
		                    data-hotkey="i"/>
		            
		            <button name="action_done" string="Mark as Done" type="object" class="oe_highlight"
		                    confirm="Mark This Appointment as Done" states="in_consultation" data-hotkey="d"/>
		            
		            <button name="action_cancel" string="Cancel" type="object" class="oe_highlight"
		                    confirm="Cancel This Appointment" states="draft" data-hotkey="c"/>
		            
		            <button name="action_draft" string="Reset To Draft" type="object" class="oe_highlight"
		                    confirm="Reset This Appointment to Draft" states="done,canceled" data-hotkey="r"/>
		            
		           <field name="state" widget="statusbar" nolabel="1"/>
	            </header>
	            <sheet>
		            <div class="oe_title">
			            <h1>
				            <field name="ref"/>
			            </h1>
		            </div>
		            <group>
			            <group string="Patient Details">
	                        <field name="patient_id"/>
	                        <field name="gender"/>
			            </group>
			            <group string="Appointment Details">
	                        <field name="doctor_id" widget="many2one_avatar"/>
	                        <field name="priority" widget="priority"/>
				            <button name="action_make_it_normal" string="Normal" type="object"
				                    class="oe_highlight mb-3" confirm="Make This Appointment Priority Normal"
				                    attrs="{'invisible': [('priority', '=', '0')]}"/>
                            <field name="appointment_date"/>
			            </group>
		            </group>
		            
		            <notebook>
			            <page name="prescription" string="Prescription">
				           <field name="prescription" placeholder="Enter Patient Prescription"/>
			            </page>
			            <page name="pharmacy" string="Pharmacy">
				            <field name="pharmacy_line_ids">
					            <tree editable="bottom">
						            <field name="product_id"/>
						            <field name="price_unit" widget="monetary"/>
						            <field name="qty"/>
					            </tree>
				            </field>
			            </page>
		            </notebook>
	            </sheet>
	            
	            <div class="oe_chatter">
		            <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread"/>
	            </div>
            </form>
        </field>
    </record>
	
	<!--tree view of the patient model-->
    <record id="appointment_tree" model="ir.ui.view">
        <field name="name">hospital.patient.tree</field>
        <field name="model">hospital.patient_appointment</field>
        <field name="arch" type="xml">
            <tree sample="1"
		          decoration-success="state == 'done'" decoration-danger="state == 'canceled'"
                  decoration-info="state == 'draft'" decoration-warning="state == 'in_consultation'" >
	            <field name="ref"/>
	            <field name="patient_id"/>
	            <field name="doctor_id" widget="many2one_avatar"/>
	            <field name="appointment_date"/>
	            <field name="activity_ids" widget="list_activity"/>
	            <field name="priority" widget="priority"/>
	            <field name="state" widget="badge"
	                   decoration-success="state == 'done'"
	                   decoration-danger="state == 'canceled'"
	                   decoration-info="state == 'draft'"
	                   decoration-warning="state == 'in_consultation'" />
            </tree>
        </field>
    </record>
	
	
	<!--search view of the patient model-->
    <record id="appointment_search" model="ir.ui.view">
        <field name="name">hospital.patient.search</field>
        <field name="model">hospital.patient_appointment</field>
        <field name="arch" type="xml">
            <search>
	            <field name="patient_id"/>
	            <field name="doctor_id"/>
	            <field name="activity_ids"/>
	            <field name="priority" />
	            <field name="state"/>
	            
	            <filter name="state_done" string="Done Appointment" domain="[('state', '=', 'done')]"/>
	            <filter name="state_canceled" string="Canceled Appointment" domain="[('state', '=', 'canceled')]"/>
	            
	            <group expand="0" string="Group By">
		            <filter name="group_by_doctor" string="Doctor" context="{'group_by': 'doctor_id'}"/>
	            </group>
	            
	            <searchpanel>
		            <field name="state" enable_counters="1" icon="" select_multi="0"/>
		            <field name="priority" enable_counters="1" icon="" select_multi="0"/>
	            </searchpanel>
	            
            </search>
        </field>
    </record>
	
	<!-- 	Action For All Patient -->
	<record id="action_hospital_patient_appointment" model="ir.actions.act_window">
		<field name="name">Appointment</field>
		<field name="type">ir.actions.act_window</field>
		<field name="res_model">hospital.patient_appointment</field>
		<field name="view_mode">tree,form</field>
		<field name="context">{}</field>
		<field name="help" type="html">
			<p class="o_view_nocontent_smiling_face">
				Create Your First Appointment!
			</p>
		</field>
	</record>
	
	<!-- 	Menu For All Patient -->
	<menuitem id="menu_all_appointment"
	          name="All Appointment"
	          action="action_hospital_patient_appointment"
	          parent="menu_appointment_master"
	          sequence="0"/>
</odoo>